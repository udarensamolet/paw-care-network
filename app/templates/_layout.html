<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Paw Care Network</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
    <link rel="icon" type="image/svg+xml" href="{{ url_for('static', filename='favicon.svg') }}">
    <link rel="apple-touch-icon" sizes="180x180" href="{{ url_for('static', filename='apple-touch-icon.png') }}">
    <meta name="theme-color" content="#F5E6D3">

</head>

<body>
    <header class="nav">
        <a class="brand" href="{{ url_for('index') }}" aria-label="Go to home">🐾 Paw Care Network</a>

        <nav>
            {% if current_user.is_authenticated %}
            <a href="{{ url_for('auth.logout') }}">Logout</a>
            {% else %}
            <a href="{{ url_for('auth.login') }}">Login</a>
            <a href="{{ url_for('auth.register') }}">Register</a>
            {% endif %}
        </nav>
    </header>


    {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
    <div class="flash-wrap">
        {% for category, msg in messages %}
        {% set cls = 'flash' %}
        {% if category in ['success','info','warning','danger','error'] %}
        {% set cls = 'flash flash--' + category %}
        {% endif %}
        {% set role = 'status' %}
        {% if category in ['warning','danger','error'] %}
        {% set role = 'alert' %}
        {% endif %}
        {# timeout: 0 = no auto-hide #}
        {% set timeout = 4500 %}
        {% if category in ['warning','danger','error'] %}
        {% set timeout = 0 %}
        {% endif %}

        <div class="{{ cls }}" role="{{ role }}" aria-live="polite" data-timeout="{{ timeout }}">
            <button class="flash__close" aria-label="Dismiss">&times;</button>
            {{ msg }}
        </div>
        {% endfor %}
    </div>
    {% endif %}
    {% endwith %}

    <!-- Auto-hide + close behavior -->
    <script>
        (function () {
            function dismiss(el) {
                el.classList.add('flash--hidden');
                el.addEventListener('transitionend', () => el.remove(), {
                    once: true
                });
            }
            document.querySelectorAll('.flash').forEach(el => {
                const timeout = parseInt(el.dataset.timeout || '0', 10);
                let timer = null;
                if (timeout > 0) {
                    timer = setTimeout(() => dismiss(el), timeout);
                    el.addEventListener('mouseenter', () => {
                        if (timer) clearTimeout(timer);
                    });
                    el.addEventListener('mouseleave', () => {
                        timer = setTimeout(() => dismiss(el), 1500);
                    });
                }
                const btn = el.querySelector('.flash__close');
                if (btn) {
                    btn.addEventListener('click', () => dismiss(el));
                }
            });
        })();
    </script>


    {% block content %}{% endblock %}

    <footer class="footer">
        © {{ 2025 }} Paw Care Network | Built by udarensamolet
    </footer>
</body>

</html>